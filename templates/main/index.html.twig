{% extends 'base.html.twig' %}

{% block title %}Cr√©ation Sortie{% endblock %}

{% block body %}

<div class="container">
    {{ form_start(formSortie) }}
    <div class="row">
        <div class="col-5">        
            {{ form_row(formSortie.nom) }}
            {{ form_row(formSortie.dateHeureDebut) }}
            {{ form_row(formSortie.duree) }}
            {{ form_row(formSortie.dateLimiteInscription) }}
            {{ form_row(formSortie.nbInscriptionMax) }}
            {{ form_row(formSortie.infosSortie) }}
            {{ form_row(formSortie.save) }}
        </div>
        <div class="col-5 offset-2">
            {{ form_row(formSortie.lieu) }}
            <div id="display">    
                <p> Ville: <span id="ville" ></span></p>
                <p> Rue: <span id="rue" ></span></p>    
                <p> Code postal: <span id="cp" ></span></p>
                <p> Latitude: <span id="lat" ></span></p>
                <p> Longitude: <span id="long" ></span></p>    
            </div>            
        </div>
    </div>
    {{ form_end(formSortie) }}
</div>


{% endblock %}

{% block javascripts %}
<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
<script>

    jQuery(document).ready(function($){
        $("select").change(function(){
          
            fetch("http://127.0.0.1:8000/lieu/"+this.value)
                .then(response=> response.json())
                .then(
                    lieu=>{
                        $("#cp").html(lieu.ville.codePostal)
                        $("#rue").html(lieu.rue)
                        $("#ville").html(lieu.ville.nom)
                        $("#lat").html(lieu.latitude)
                        $("#long").html(lieu.longitude)
                    }
                )
                .catch(
                    err=>{
                        $("#cp").html("")
                        $("#ville").html("")
                        $("#rue").html("")
                        $("#lat").html("")
                        $("#long").html("")                      
                    }
                )
        })
    })

</script>
{% endblock %}